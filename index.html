<html>
<link rel="stylesheet" type="text/css" href="css/skeleton.css"/>
<link rel="stylesheet" type="text/css" href="css/style.css"/>
<div id="header">
  <img id="logo" src="img/logo.svg" alt="Komisyon" width="100px">
</div>
<div class="wrapper row" id="wrapper">
  <div id="subwrapper">
  <!--INGRESO DE DATOS-->
  <div class="inputs">
    <!--Nombre de la Materia-->
    <div class="row nameMateria">
      <input id="nameSubject" class="nameSubject u-full-width" type="text" placeholder="Materia"/>
    </div>

    <!--Comisiones-->
    <div class="row comisiones">
      <div class="row comissions">
        <div class="nameComision three columns">
          <input class="comission" type="text" placeholder="Comision"/>
        </div>

        <!--Horarios-->
        <div class="nine columns hour horarios">
          <div class="row schedules">
            <div class="row schedule">
              <div class="four columns">
                <select class="day u-full-width">
                  <option value="Default">Dia</option>
                  <option value="Lunes">Lunes</option>
                  <option value="Martes">Martes</option>
                  <option value="Miercoles">Miercoles</option>
                  <option value="Jueves">Jueves</option>
                  <option value="Viernes">Viernes</option>
                  <option value="Sabado">Sabado</option>
                </select>
              </div>
              <div class="four columns"><input class="startHour u-full-width" type="time" placeholder="Hora de Inicio"/></div>
              <div class="four columns"><input class="finishHour u-full-width" type="time" placeholder="Hora de Finalizacion"/></div>
            </div>
          </div>
          <!--Boton Añadir Horario-->
          <button class="u-full-width addHour boton">Añadir Horario</button>
        </div>
      </div>
    </div>
    <button class="u-full-width addCommission boton">Añadir Comisión</button>
  </div>
</div>
<button class="u-full-width addSubject boton">Añadir Materia</button>
<button id="execHorarios" class="u-full-width boton">Generar Horarios</button>
</div>
</html>

<script src="js/jquery-3.2.1.min.js"></script>
<script src="js/class.js"></script>
<script src="js/gui.js"></script>

<script>

$(document).on("click","#execHorarios",function(){
  console.log(getAndCreateData());
});

function getAndCreateData(){
  // Obtiene los datos de los inputs y crea los objetos para su posterior procesado.
  // Extremadamente ligado a la estructura del HTML, NO CAMBIAR HTML.
  var materias = [];
  //  Levantar datos de los "inputs"
  $("#subwrapper").children("div[class*='inputs']").each(function(){
    // Levantar nombre de materia
    inputNameMateria=$(this).children("div[class*='nameMateria']").children();
    nameMateria=inputNameMateria.val();
    var comisiones = [];

    // Recorrer todas las comisiones de la materia
    $(this).children("div[class*='comisiones']").children("div[class*='comissions']").each(function(){
      var horarios = [];
      inputnameComision=$(this).children("div[class*='nameComision']").children();
      nameComision=inputnameComision.val();

      // Recorrer todas los horarios de la comision
      $(this).children("div[class*='horarios']").children("div[class*='schedules']").each(function(){
        scheduleInfo=$(this).children("div[class*='schedule']").each(function(){
          dia=$(this).children("div[class*='four']").children("select[class*='day']").val();
          startHour=$(this).children("div[class*='four']").children("input[class*='startHour']").val();
          finishHour=$(this).children("div[class*='four']").children("input[class*='finishHour']").val();
          //Crear objeto horario y ponerlo en el array horarios
          var horario = new Horario(dia, startHour , finishHour);
          horarios.push(horario);
        });
      });

      //Crear objeto comision y ponerlo en el array comisiones
      var comision = new Comision(nameComision,horarios);
      comisiones.push(comision);
    });
    //Crear objeto materia y ponerlo en el array materias
    var materia = new Materia(nameMateria,comisiones);
    materias.push(materia);
  });
  // Devolver las materias (Devolver el array de las materias)
  return materias;
};

</script>

<script type="text/javascript">
// var horario1 = new Horario('Martes','11:30','12:30');
// var horarios = {horario1};
// var comision1 = new Comision('Roberto',horarios);
// var comisiones = {comision1}
// var materia1 = new Materia('Informatica',comisiones);
// console.log(materia1.getNombre());
// console.log(materia1.getComisiones());
</script>
